Disini saya akan membuat temporary table yang betujuan untuk menyajikan data penjualan produk setiap bulannya. Dataset yang saya gunakan yaitu thelook_ecommerce dari Big Query Public Data.


Penjelasan mengenai code yang saya gunakan:

1. **CREATE TEMP TABLE MONTHLY_SALES AS**: query ini digunakan untuk membuat temporary table bernama monthly_sales
2. **SELECT**: query ini digunakan untuk memilih semua kolom yang disebutkan dari tabel yang telah ditentukan
3. **FORMAT_DATE('%Y', oi.created_at) AS YEAR**: query ini digunakan untuk mengambil dan hanya menampilkan data tahun dari kolom created_at pada tabel order_items atau oi dan diberikan nama alias 'year'. Pemberian nama alias ini akan memudahkan pembaca dalam membaca tabel nantinya
4. **FORMAT_DATE('%B', oi.created_at) AS MONTH**: query ini digunakan untuk mengambil dan hanya menampilkan data bulan dari kolom created_at pada tabel order_items atau oi dan diberikan nama alias 'month'
5. **p.id AS PRODUCT_ID**: query ini digunakan untuk memilih kolom id dari tabel products atau p dan diberikan nama alias 'product_id'
6. **p.name AS PRODUCT_NAME**: query ini digunakan untuk memilih kolom name dari tabel products atau p dan diberikan nama alias 'product_name'
7. **SUM(o.num_of_item) AS TOTAL_QUANTITY**: query ini digunakan untuk menjumlah data dari kolom num_of_item pada tabel orders atau o dan diberikan nama alias 'total_quantity'
8. **ROUND(SUM(o.num_of_item * oi.sale_price), 2) AS TOTAL_SALES**: query ini digunakan untuk melakukan perkalian antara kolom num_of_item pada tabel orders atau o dengan kolom sale_price pada tabel order_items atau oi (o.num_of_item * oi.sale_price). Kemudian dilakukan penjumlahan (SUM) dan terakhir menggunakan fungsi ROUND yang artinya untuk membulatkan hasil penjumlahan tadi ke beberapa angka di belakang koma, disini saya mengaturnya ke 2 angka dibelakang koma. Lalu diberikan nama alias 'total_sales'
9. **FROM `bigquery-public-data.thelook_ecommerce.order_items` oi**: query ini mengakses data dari tabel order_items yang berada dalam dataset thelook_ecommerce yang merupakan bagian dari bigquery-public-data dan diberikan nama alias 'oi'. Nama alias ini mempermudah kita jika ingin mengakses kolom dari tabel tersebut tanpa perlu mengetik nama tabel secara keseluruhan
10. **LEFT JOIN `bigquery-public-data.thelook_ecommerce.orders` o**: query ini digunakan untuk menggabungkan baris dari kedua tabel yang mana penggabungan ini akan mengembalikan semua baris dari tabel kiri (tabel yang disebutkan sebelum left join yaitu tabel order_items) dan baris yang sama persis dari tabel kanan (tabel yang disebutkan setelah left join atau tabel orders). Tabel orders ini diberikan nama alias 'o'
11. **ON oi.order_id = o.order_id**: query ini digunakan untuk menentukan kolom mana yang bisa digunakan dalam mencocokkan baris antara dua tabel yang ingin digabungkan. Dari tabel order_items atau oi menggunakan kolom order_id dan begitu pula dari tabel orders.
12. **LEFT JOIN bigquery-public-data.thelook_ecommerce.products p**: query ini digunakan untuk menggabungkan baris dari tabel sebelumnya dengan tabel products dan diberikan nama alias 'p'
13. **ON oi.product_id = p.id**: query ini digunakan untuk menentukan kolom yang bisa digunakan untuk mencocokan baris antara tabel order_items dengan tabel product. Dari tabel order_items atau oi menggunakan kolom product_id sedangkan dari tabel products atau p menggunakan kolom id
14. **WHERE oi.status != 'Cancelled' and oi.status != 'Returned'**: query ini memberikan kondisi tambahan dimana data yang akan ditampilkan nantinya ini tidak termasuk dalam status 'Cancelled' maupun 'Returned'. Alasan kedua status tersebut tidak dimasukkan karena produk-produk yang di cancelled otomatis merupakan produk yang tidak jadi terjual begitupula dengan produk yang di returned.
15. **GROUP BY YEAR, MONTH, PRODUCT_ID, PRODUCT_NAME**: query ini digunakan untuk melakukan pengelompokan data yang memiliki nilai yang sama berdasarkan kolom year, month, product_id dan product_name. Hal ini dilakukan agar ketika ada nilai yang sama pada ke-4 kolom tersebut maka akan digabungkan menjadi satu data.
